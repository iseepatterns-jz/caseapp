/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pytest_asyncio/plugin.py:247: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))
============================= test session starts ==============================
platform darwin -- Python 3.13.1, pytest-8.3.5, pluggy-1.5.0
rootdir: /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend
configfile: pytest.ini
plugins: langsmith-0.3.3, anyio-4.8.0, asyncio-1.3.0, hypothesis-6.150.0, typeguard-2.13.3
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 8 items

tests/test_integration_complete_workflow.py F.......                     [100%]

=================================== FAILURES ===================================
__________ TestCompleteWorkflows.test_complete_case_creation_workflow __________

self = <services.case_insight_service.CaseInsightService object at 0x114dc9010>
case_id = UUID('d1155798-71bc-4038-8f4c-05481d0e9708')
confidence_threshold = 0.7

    async def generate_case_categorization(
        self,
        case_id: str,
        confidence_threshold: float = 0.7
    ) -> Dict[str, Any]:
        """
        Generate AI-powered case categorization suggestions
    
        Args:
            case_id: UUID of the case to analyze
            confidence_threshold: Minimum confidence score for suggestions
    
        Returns:
            Dictionary with categorization suggestions and confidence scores
        """
        try:
            async with AsyncSessionLocal() as db:
                # Get case with all related data
                case_result = await db.execute(
                    select(Case)
                    .where(Case.id == case_id)
                    .options(
                        selectinload(Case.documents),
                        selectinload(Case.timelines).selectinload(CaseTimeline.events),
                        selectinload(Case.media_evidence),
                        selectinload(Case.forensic_sources)
                    )
                )
                case = case_result.scalar_one_or_none()
    
                if not case:
                    raise CaseManagementException(f"Case {case_id} not found")
    
                # Prepare case data for analysis
>               case_data = await self._prepare_case_data(case)

services/case_insight_service.py:78: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <services.case_insight_service.CaseInsightService object at 0x114dc9010>
case = <MagicMock name='mock.__aenter__().execute().scalar_one_or_none()' id='4647863360'>

    async def _prepare_case_data(self, case: Case) -> Dict[str, Any]:
        """Prepare case data for AI analysis"""
        return {
            'case_info': {
                'case_number': case.case_number,
                'title': case.title,
                'description': case.description[:1000] if case.description else "",
                'case_type': case.case_type.value,
>               'status': case.status.value,
                'priority': case.priority.value if hasattr(case, 'priority') else "medium",
                'created_at': case.created_at.isoformat(),
                'court_name': case.court_name,
                'judge_name': case.judge_name,
                'jurisdiction': case.case_jurisdiction
            },
            'documents': [
                {
                    'id': str(doc.id),
                    'filename': doc.filename,
                    'document_type': doc.document_type,
                    'ai_summary': doc.ai_summary[:500] if doc.ai_summary else "",
                    'keywords': doc.keywords[:10] if doc.keywords else [],
                    'entities': doc.entities[:20] if doc.entities else []
                }
                for doc in case.documents[:20]  # Limit to first 20 documents
            ],
            'timeline_events': [
                {
                    'id': str(event.id),
                    'title': event.title,
                    'description': event.description[:300] if event.description else "",
                    'event_type': event.event_type.value,
                    'event_date': event.event_date.isoformat() if event.event_date else None,
                    'location': event.location,
                    'participants': event.participants[:10] if event.participants else []
                }
                for timeline in case.timelines
                for event in timeline.events[:10]  # Limit events per timeline
            ],
            'media_evidence': [
                {
                    'id': str(media.id),
                    'filename': media.filename,
                    'media_type': media.media_type,
                    'file_size': media.file_size,
                    'duration': media.duration,
                    'transcription': media.transcription[:500] if media.transcription else ""
                }
                for media in case.media_evidence[:10]  # Limit to first 10 media files
            ],
            'forensic_sources': [
                {
                    'id': str(source.id),
                    'source_name': source.source_name,
                    'source_type': source.source_type,
                    'analysis_status': source.analysis_status.value,
                    'device_info': source.device_info,
                    'account_info': source.account_info
                }
                for source in case.forensic_sources[:5]  # Limit to first 5 sources
            ]
        }
E       AttributeError: 'str' object has no attribute 'value'

services/case_insight_service.py:447: AttributeError

During handling of the above exception, another exception occurred:

self = <tests.test_integration_complete_workflow.TestCompleteWorkflows object at 0x106ca5950>
mock_db_session = <AsyncMock name='mock.__aenter__()' id='4635444960'>
sample_case_data = {'case_number': 'CASE-2024-001', 'case_type': 'civil', 'client_id': 'client-123', 'description': 'Test case for integration testing', ...}

    @pytest.mark.asyncio
    async def test_complete_case_creation_workflow(self, mock_db_session, sample_case_data):
        """
        Test complete case creation workflow
        """
        # Initialize services
        audit_service = AuditService(mock_db_session)
        case_service = CaseService(mock_db_session, audit_service)
        document_service = DocumentService(mock_db_session, audit_service)
        timeline_service = TimelineService(mock_db_session, audit_service)
        insight_service = CaseInsightService()
        export_service = ExportService()
    
        # Mock database operations
        # Removed redundant/incorrect get_db patches
        if True:
    
                    # Step 1: Create case (Mocked as it is not the focus here)
                    case_id = uuid.uuid4()
                    user_id = uuid.uuid4()
                    mock_case = MagicMock()
                    mock_case.id = case_id
                    mock_case.case_number = sample_case_data["case_number"]
                    mock_case.title = sample_case_data["title"]
                    mock_case.status = "active"
    
                    # Setup mock execute result
                    mock_result = MagicMock()
                    mock_result.scalar_one_or_none.return_value = mock_case
                    mock_result.scalar.return_value = 0
                    mock_db_session.execute.return_value = mock_result
    
                    # Use a proper mock for the result of create_case
                    with patch.object(case_service, 'create_case', return_value=mock_case):
                        # The created_case variable was missing, using case instead
                        case = await case_service.create_case(sample_case_data, user_id)
                        created_case = case
    
                        # Verify case creation
                        assert case.id == case_id
                        assert case.case_number == sample_case_data["case_number"]
    
                        # Step 2: Upload document
                        mock_document = MagicMock()
                        mock_document.id = "doc-123"
                        mock_document.filename = "test_document.pdf"
                        mock_document.case_id = created_case.id
    
                        mock_db_session.scalar.return_value = mock_document
    
                        # Fix: patch.object on the service instance instead of module
                        document_service.s3_client = MagicMock()
                        document_service.s3_client.put_object = MagicMock()
    
                        # Mock the dependencies of upload_document if needed
                        with patch.object(document_service, '_get_case', return_value=MagicMock()):
                            # Create a mock file and upload request
                            mock_file = MagicMock()
                            mock_file.read = AsyncMock(return_value=b"Mock content")
                            mock_file.content_type = "application/pdf"
                            mock_file.filename = "test_document.pdf"
    
                            upload_request = DocumentUploadRequest(
                                case_id=created_case.id,
                                document_type=DocumentType.OTHER
                            )
    
                        # Mock DocumentAnalysisService.analyze_document to avoid coroutine issues
                        with patch('services.document_analysis_service.DocumentAnalysisService.analyze_document', new_callable=AsyncMock) as mock_analyze:
                            mock_analyze.return_value = MagicMock()
    
                            uploaded_doc = await document_service.upload_document(
                                file=mock_file,
                                upload_request=upload_request,
                                uploaded_by=user_id
                            )
    
                        # Verify document upload
                        assert uploaded_doc is not None
                        assert uploaded_doc.original_filename == "test_document.pdf"
    
                        # Step 3: Create timeline event
                        mock_event = MagicMock()
                        mock_event.id = "event-123"
                        mock_event.title = "Document Uploaded"
                        mock_event.case_id = created_case.id
    
                        mock_db_session.scalar.return_value = mock_event
    
                        # Fixed method name from create_event to create_timeline_event
                        timeline_event = await timeline_service.create_timeline_event(
                            event_request=TimelineEventCreateRequest(
                                case_id=created_case.id,
                                title="Document Uploaded",
                                description="Test document uploaded",
                                event_date=datetime.utcnow(),
                                event_type=EventType.EVIDENCE_COLLECTION
                            ),
                            created_by=user_id
                        )
    
                        # Verify timeline event
                        assert timeline_event is not None
                        assert timeline_event.title == "Document Uploaded"
    
                        # Step 4: Generate AI insights
                        # Step 4: Generate AI insights
                        with patch.object(insight_service, 'bedrock_client') as mock_bedrock:
                            mock_bedrock.invoke_model = AsyncMock(return_value={
                                'body': MagicMock(read=lambda: json.dumps({
                                    "completion": json.dumps({
                                        "category": "civil_litigation",
                                        "confidence": 0.85,
                                        "reasoning": "Test reasoning"
                                    })
                                }).encode())
                            })
    
                            # Patch AsyncSessionLocal to return the mock session
                            mock_cm = AsyncMock()
                            mock_cm.__aenter__.return_value = mock_db_session
                            with patch('services.case_insight_service.AsyncSessionLocal', return_value=mock_cm):
>                               insights = await insight_service.generate_case_categorization(
                                    case_id=created_case.id
                                )

tests/test_integration_complete_workflow.py:196: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <services.case_insight_service.CaseInsightService object at 0x114dc9010>
case_id = UUID('d1155798-71bc-4038-8f4c-05481d0e9708')
confidence_threshold = 0.7

    async def generate_case_categorization(
        self,
        case_id: str,
        confidence_threshold: float = 0.7
    ) -> Dict[str, Any]:
        """
        Generate AI-powered case categorization suggestions
    
        Args:
            case_id: UUID of the case to analyze
            confidence_threshold: Minimum confidence score for suggestions
    
        Returns:
            Dictionary with categorization suggestions and confidence scores
        """
        try:
            async with AsyncSessionLocal() as db:
                # Get case with all related data
                case_result = await db.execute(
                    select(Case)
                    .where(Case.id == case_id)
                    .options(
                        selectinload(Case.documents),
                        selectinload(Case.timelines).selectinload(CaseTimeline.events),
                        selectinload(Case.media_evidence),
                        selectinload(Case.forensic_sources)
                    )
                )
                case = case_result.scalar_one_or_none()
    
                if not case:
                    raise CaseManagementException(f"Case {case_id} not found")
    
                # Prepare case data for analysis
                case_data = await self._prepare_case_data(case)
    
                # Generate categorization using AI
                prompt = self._build_categorization_prompt(case_data)
                response = await self._call_bedrock_model(prompt)
    
                # Parse and validate response
                categorization = self._parse_categorization_response(response)
    
                # Filter by confidence threshold
                filtered_suggestions = {
                    category: details for category, details in categorization.items()
                    if details.get('confidence', 0) >= confidence_threshold
                }
    
                logger.info("Generated case categorization",
                           case_id=case_id,
                           suggestions_count=len(filtered_suggestions))
    
                return {
                    'case_id': case_id,
                    'categorization': filtered_suggestions,
                    'generated_at': datetime.utcnow().isoformat(),
                    'confidence_threshold': confidence_threshold,
                    'model_used': self.model_id
                }
    
        except Exception as e:
            logger.error("Failed to generate case categorization",
                        case_id=case_id, error=str(e))
>           raise CaseManagementException(f"Case categorization failed: {str(e)}")
E           core.exceptions.CaseManagementException: Case categorization failed: 'str' object has no attribute 'value'

services/case_insight_service.py:108: CaseManagementException
----------------------------- Captured stdout call -----------------------------
2026-01-17 10:21:10 [info     ] File uploaded to S3            file_size=12 s3_key=documents/d1155798-71bc-4038-8f4c-05481d0e9708/2026/01/17/1addda571598475fab59557d4da05684/7e00d74d.pdf
2026-01-17 10:21:10 [info     ] Audit log created              action=upload audit_id=None entity_id=None entity_name=test_document.pdf entity_type=document user_id=6040a02d-72aa-4d46-86be-bbdf800a58a1
2026-01-17 10:21:10 [info     ] Document uploaded successfully case_id=d1155798-71bc-4038-8f4c-05481d0e9708 document_id=None filename=test_document.pdf
2026-01-17 10:21:10 [info     ] Audit log created              action=create audit_id=None entity_id=None entity_name=None entity_type=timeline_event user_id=6040a02d-72aa-4d46-86be-bbdf800a58a1
2026-01-17 10:21:10 [info     ] Timeline event created         case_id=d1155798-71bc-4038-8f4c-05481d0e9708 event_id=None title='Document Uploaded'
2026-01-17 10:21:10 [error    ] Failed to generate case categorization case_id=UUID('d1155798-71bc-4038-8f4c-05481d0e9708') error="'str' object has no attribute 'value'"
=============================== warnings summary ===============================
../../../../../../Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydantic/_internal/_config.py:295: 15 warnings
  /Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pydantic/_internal/_config.py:295: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

core/database.py:210
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/core/database.py:210: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

schemas/case.py:69
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/case.py:69: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('closure_reason')

schemas/timeline.py:53
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/timeline.py:53: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('end_date')

schemas/media.py:83
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:83: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('tags', 'categories')

schemas/media.py:89
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:89: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('privilege_reason')

schemas/media.py:113
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:113: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('tags', 'categories')

schemas/media.py:119
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:119: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('admissibility_status')

schemas/media.py:143
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:143: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('admissibility_status')

schemas/media.py:162
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:162: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('annotation_type')

schemas/media.py:169
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:169: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('color')

schemas/media.py:175
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:175: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('opacity')

schemas/media.py:181
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:181: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('relevance_score')

schemas/media.py:187
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:187: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('end_time')

schemas/media.py:206
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:206: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('color')

schemas/media.py:212
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:212: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('opacity')

schemas/media.py:218
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:218: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('relevance_score')

schemas/media.py:375
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:375: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('analysis_types')

schemas/media.py:383
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/schemas/media.py:383: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    @validator('priority')

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_complete_case_creation_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/document_service.py:102: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    unique_filename = f"{datetime.utcnow().strftime('%Y/%m/%d')}/{uuid.uuid4().hex}/{file_hash[:8]}{file_extension}"

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_complete_case_creation_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/document_service.py:116: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'upload_timestamp': datetime.utcnow().isoformat()

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_complete_case_creation_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/tests/test_integration_complete_workflow.py:169: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    event_date=datetime.utcnow(),

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_forensic_analysis_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/export_service.py:375: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    story.append(Paragraph(f"Generated: {datetime.utcnow().strftime('%Y-%m-%d %H:%M UTC')}", styles['Normal']))

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_background_job_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/background_job_service.py:137: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_at=datetime.utcnow(),

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_background_job_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/webhook_service.py:135: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_at=datetime.utcnow(),

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_background_job_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/webhook_service.py:136: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    updated_at=datetime.utcnow()

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_background_job_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/background_job_service.py:270: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    cutoff_time = datetime.utcnow() - timedelta(hours=hours)

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_security_workflow
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/encryption_service.py:65: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    'encrypted_at': datetime.utcnow().isoformat(),

tests/test_integration_complete_workflow.py: 45 warnings
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/health_service.py:46: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self.timestamp = datetime.utcnow()

tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_service_manager_workflow
tests/test_integration_complete_workflow.py::TestErrorHandlingAndRecovery::test_service_failure_recovery
  /Users/showboat/locker/AGRAV-ISEEPATTERNS/caseapp/backend/services/health_service.py:95: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow().isoformat(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_integration_complete_workflow.py::TestCompleteWorkflows::test_complete_case_creation_workflow
=================== 1 failed, 7 passed, 89 warnings in 1.46s ===================
